use student;


-- Write a query to create a new table employees where the employees columns emp_id, emp_name, department, salary, city
create table employees(
emp_id int auto_increment primary key ,
emp_name varchar(20),
department varchar(50),
salary int,
city varchar(20)
);


drop table employees;

-- insert 5 data in the table
insert into employees(emp_name, department, salary, city) values ('ABC', 'IT', 20000, 'Nagpur');
insert into employees(emp_name, department, salary, city) values ('XYZ', 'HR', 50000, 'Delhi');
insert into employees(emp_name, department, salary, city) values ('PQR', 'IT', 82000, 'Pune');
insert into employees(emp_name, department, salary, city) values ('Alpha', 'Developer', 58000, 'Delhi');
insert into employees(emp_name, department, salary, city) values ('Beta', 'HR', 10000, 'Nagpur');

-- Display the records
select * from employees;

-- Get the record having second highest salary
 select MAX(salary) FROM employees WHERE salary < (SELECT MAX(salary) FROM employees);
 Select * from employees order by salary desc limit 1 offset 1;
 -- Third highest
 Select * from employees order by salary desc limit 1 offset 2;
 
 -- Display the unique cities from the employee table
 SELECT DISTINCT city FROM employees;  
 
 -- Write a query to get unique departments
 SELECT DISTINCT department FROM employees;
 
 -- Write a query to count number of the different city employee belongs to
 SELECT COUNT(DISTINCT city) FROM employees;
 
 -- Display unique city department combination from employee table
  SELECT distinct department, city FROM employees;
  
  -- Display employees from delhi or nagpur
  SELECT * FROM employees WHERE city IN ('Nagpur', 'delhi');
  
  -- Display the the employee working as HR or IT
  SELECT * FROM employees WHERE department IN ('HR', 'IT');
  
  -- Display employee not from delhi or pune
 SELECT * FROM employees WHERE city NOT IN ('pune', 'delhi');
 
 -- Display empolyees with salary 10000, 20000, 30000
 SELECT * FROM employees WHERE salary IN (10000, 20000, 30000);
 
 -- Display the employees salary between 10000 and 30000
 SELECT * FROM employees WHERE salary BETWEEN 10000 AND 30000;
 
 -- Display the employees salary between 10000 and 30000 in asceending order
 SELECT * FROM employees WHERE salary BETWEEN 10000 AND 30000 ORDER BY salary ASC;
 
 insert into employees(emp_name, department, salary, city) values ('Mukesh', 'HR', 108500, 'Nagpur');
 insert into employees(emp_name, department, salary, city) values ('Rahesh', 'IT', 501560, 'Pune');
 select * from employees;
 
 -- Display employees whose name have 4 letters 
 SELECT emp_name FROM employees WHERE LENGTH(emp_name) = 4;
 
  -- Display employees whose name have 4 letters using like operator 
  SELECT emp_name FROM employees where emp_name like '____';
 
 -- Display employees wiht 6 digit salary
 SELECT * FROM employees WHERE salary >= 100000 AND salary <= 999999;
 
 
 SELECT * FROM employees WHERE LENGTH(emp_name) = 4 OR salary BETWEEN 100000 AND 999999;
 
 
 -- COUNT total number of employees having salary greater than 30000
 SELECT count(*) FROM employees WHERE salary > 30000;
 
 -- Find average salary of all employee
SELECT AVG(salary) FROM employees;
 
 -- Find total amount that company have to paid to all employees
 SELECT SUM(salary) FROM employees;
 
 -- Find the list of employees whose salary less than average
 SELECT * FROM employees WHERE salary < (SELECT AVG(salary) FROM employees);
 
 -- Find the minimum and maximum salary of the employees
 SELECT MAX(salary) AS MAXIMUM_SALARY, MIN(salary) AS MAXIMUM_SALARY FROM employees;
 
 -- Write a query to count number of employee in each city
 SELECT city, COUNT(*) FROM employees GROUP BY city;
 
 -- Find name of employees with maximum salary deparment wise
 SELECT department, MAX(salary) FROM employees GROUP BY department;
 
SELECT e.emp_name, e.department, e.salary FROM employees e
WHERE e.salary = (
    SELECT MAX(e2.salary)
    FROM employees e2
    WHERE e2.department = e.department
);

SELECT MAX(e2.salary)
    FROM employees e2
    WHERE e2.department = 'developer';
 
 -- Write a query to count employees department wise in each city
SELECT department, city, COUNT(*) AS total_employees FROM employees GROUP BY department, city;
 
 -- Display cities with more than one employee
 SELECT city, COUNT(*) FROM employees GROUP BY city HAVING count(*) > 1;
 
 -- Display department with average salary greater than 30000
 Select department, avg(salary) FROM employees GROUP BY department Having avg(salary) > 30000;

-- String functions
-- Display employees names in uppercase and department in lowercase
Select upper(emp_name), lower(department) FROM employees;

-- Find the length of each employee name
Select emp_name, length(emp_name) as length FROM employees;

-- Display first 3 character from employees name 
-- Syntax -> substring(emp_name, startindex, lastindex) 
SELECT SUBSTRING(emp_name,1,3) FROM employees;
SELECT emp_name, LEFT(emp_name,3) from employees;

-- Display last 2 character from employee name
SELECT SUBSTRING(emp_name,-2) FROM employees;
SELECT SUBSTRING(emp_name,length(emp_name)-1,length(emp_name)) FROM employees;
SELECT emp_name, RIGHT(emp_name,2) from employees;

-- Display employees not working in HR department
SELECT * FROM employees WHERE department != 'HR';
SELECT * FROM employees WHERE department <> 'HR';
select emp_name, department from employees where department not in ('HR');

-- Display employee name and city in single coloumn sep by -
SELECT concat(emp_name,'-',city) AS name_city from employees;

-- Remove extra spaced from employee name;
SELECT TRIM(emp_name) as emp from employees;

-- Display employee whose name starts with vowels
Select * from employees where Lower(emp_name) like 'a%' OR Lower(emp_name) like 'e%' OR Lower(emp_name) like 'i%'   OR Lower(emp_name) like 'o%' OR Lower(emp_name) like 'u%';
select emp_name from employees where left(lower(emp_name), 1) in ('a','e','i','o','u');
select * from employees where upper(emp_name) like "A%" || "E%" || "I%" || "O%" || "U%";

 -- Write a query to print name after replacing 'a' with 'A'
 SELECT replace(emp_name,'a','A') FROM employees; 
 
 